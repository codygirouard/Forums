{"ast":null,"code":"import _toConsumableArray from\"C:/Users/cag0398/Desktop/forums/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:/Users/cag0398/Desktop/forums/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useReducer,useState}from'react';import{useNavigate,useParams}from'react-router-dom';import Header from'./header';import{dateToString}from'./postDate';import{LikeButton}from'./like';import Alert from'./alert';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Reply=function Reply(_ref){var reply=_ref.reply;var author=reply.author,body=reply.body,date=reply.date;var time=dateToString(date);return/*#__PURE__*/_jsxs(\"div\",{className:\"reply\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"authorTime\",children:[/*#__PURE__*/_jsx(\"h5\",{children:author}),/*#__PURE__*/_jsx(\"p\",{className:\"time\",children:time})]}),/*#__PURE__*/_jsx(\"p\",{className:\"bodyText\",children:body})]});};var Replies=function Replies(_ref2){var replies=_ref2.replies;return/*#__PURE__*/_jsx(\"div\",{className:\"replies\",children:replies.slice().reverse().map(function(reply){return/*#__PURE__*/_jsx(Reply,{reply:reply},reply._id);})});};var Comment=function Comment(_ref3){var postId=_ref3.postId,commentId=_ref3.commentId,comment=_ref3.comment;var author=comment.author,body=comment.body,date=comment.date;var _useState=useState(comment.replies),_useState2=_slicedToArray(_useState,2),replies=_useState2[0],setReplies=_useState2[1];var time=dateToString(date);var _useState3=useState('Type reply here...'),_useState4=_slicedToArray(_useState3,2),replyText=_useState4[0],setText=_useState4[1];var _useReducer=useReducer(function(hideCommentBox){return!hideCommentBox;},true),_useReducer2=_slicedToArray(_useReducer,2),hideCommentBox=_useReducer2[0],toggleHideCommentBox=_useReducer2[1];var toggleReplyBox=function toggleReplyBox(){var user=localStorage.getItem('name');var alertModal=document.getElementById('alertModal');var alertText=document.getElementById('alertText');if(!user){alertText.innerHTML='You need to login to reply!';alertModal.style.display='block';}else{toggleHideCommentBox();}};// reply box submit button clicked\nvar handleClick=function handleClick(_ref4){var target=_ref4.target;var user=localStorage.getItem('name');var alertModal=document.getElementById('alertModal');var alertText=document.getElementById('alertText');if(!user){alertText.innerHTML='You need to login to submit replies!';alertModal.style.display='block';}else if(replyText==='Type reply here...'){alertText.innerHTML='You need to enter text to post a reply!';alertModal.style.display='block';}else{var replyInfo={postId:postId,commentId:commentId,author:user,body:replyText};var options={method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(replyInfo)};fetch('/be/newReply',options);setReplies(function(oldReplies){return[].concat(_toConsumableArray(oldReplies),[{_id:Math.floor(Math.random()*100000),date:'A few seconds ago...',author:user,body:replyText}]);});setText('Type reply here...');}target.blur();toggleHideCommentBox();};var handleInput=function handleInput(_ref5){var target=_ref5.target;target.style.height='';target.style.height=target.scrollHeight+5+'px';setText(target.value);};var handleFocus=function handleFocus(_ref6){var target=_ref6.target;if(target.value==='Type reply here...'){target.value='';}};var handleBlur=function handleBlur(_ref7){var target=_ref7.target;if(target.value===''){target.value='Type reply here...';}};return/*#__PURE__*/_jsxs(\"div\",{className:\"comment\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"authorTime\",children:[/*#__PURE__*/_jsx(\"h5\",{children:author}),/*#__PURE__*/_jsx(\"p\",{className:\"time\",children:time})]}),/*#__PURE__*/_jsx(\"p\",{className:\"bodyText\",children:body}),/*#__PURE__*/_jsx(\"button\",{className:\"replyToggleBtn\",onClick:toggleReplyBox,children:\"Reply\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"replyContainer\",style:{display:hideCommentBox?'none':'block'},children:[/*#__PURE__*/_jsx(\"textarea\",{className:\"commentBox\",\"aria-label\":\"Reply Box\",rows:\"1\",cols:\"1\",name:\"Reply Box\",value:replyText,maxLength:500,onFocus:handleFocus,onBlur:handleBlur,onInput:handleInput}),/*#__PURE__*/_jsxs(\"button\",{className:\"commentBtn\",onClick:handleClick,children:[/*#__PURE__*/_jsxs(\"svg\",{width:\"100px\",height:\"30px\",viewBox:\"0 0 100 30\",className:\"border\",children:[/*#__PURE__*/_jsx(\"polyline\",{points:\"99,1 99,29 1,29 1,1 99,1\",className:\"bg-line\"}),/*#__PURE__*/_jsx(\"polyline\",{points:\"99,1 99,29 1,29 1,1 99,1\",className:\"hl-line\"})]}),/*#__PURE__*/_jsx(\"span\",{children:\"Submit\"})]})]}),/*#__PURE__*/_jsx(Replies,{replies:replies})]});};var Comments=function Comments(_ref8){var id=_ref8.id,comments=_ref8.comments;return/*#__PURE__*/_jsx(\"div\",{className:\"comments\",children:comments.slice().reverse().map(function(comment){return/*#__PURE__*/_jsx(Comment,{postId:id,commentId:comment._id,comment:comment},comment._id);})});};var Content=function Content(_ref9){var postId=_ref9.postId,likes=_ref9.likes,usersLiked=_ref9.usersLiked,author=_ref9.author,body=_ref9.body,title=_ref9.title,date=_ref9.date;var time=dateToString(date);return/*#__PURE__*/_jsxs(\"div\",{className:\"content\",children:[/*#__PURE__*/_jsx(LikeButton,{totalLikes:likes,usersLiked:usersLiked,postId:postId}),/*#__PURE__*/_jsxs(\"div\",{className:\"contentPost\",children:[/*#__PURE__*/_jsx(\"h3\",{children:title}),/*#__PURE__*/_jsxs(\"div\",{className:\"authorTime\",children:[/*#__PURE__*/_jsx(\"h5\",{children:author}),/*#__PURE__*/_jsx(\"p\",{className:\"time\",children:time})]}),/*#__PURE__*/_jsx(\"p\",{className:\"bodyText\",children:body})]})]});};export var Post=function Post(){var _useParams=useParams(),id=_useParams.id;var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),data=_useState6[0],setData=_useState6[1];var _useState7=useState('Type comment here...'),_useState8=_slicedToArray(_useState7,2),commentText=_useState8[0],setText=_useState8[1];var nav=useNavigate();useEffect(function(){fetch(\"/be/getPost/\".concat(id)).then(function(response){return response.json();}).then(function(response){// post id not found\nif(!response||response.err){nav('/oops');}else{setData(response);document.title=\"\".concat(response.title,\" - Denton Forums\");}});},[nav,id]);var handleInput=function handleInput(_ref10){var target=_ref10.target;target.style.height='';target.style.height=target.scrollHeight+5+'px';setText(target.value);};var handleFocus=function handleFocus(_ref11){var target=_ref11.target;if(target.value==='Type comment here...'){target.value='';}};var handleBlur=function handleBlur(_ref12){var target=_ref12.target;if(target.value===''){target.value='Type comment here...';}};// comment submit button clicked\nvar handleClick=function handleClick(_ref13){var target=_ref13.target;var user=localStorage.getItem('name');var alertModal=document.getElementById('alertModal');var alertText=document.getElementById('alertText');if(!user){alertText.innerHTML='You need to login to submit comments!';alertModal.style.display='block';}else if(commentText==='Type comment here...'){alertText.innerHTML='You need to enter text to post a comment!';alertModal.style.display='block';}else{var commentInfo={postId:id,author:user,body:commentText};var options={method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(commentInfo)};fetch('/be/newComment',options).then(function(response){return response.json();}).then(function(response){return setData(response.result);});setText('Type comment here...');}target.blur();};if(!data){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(\"div\",{className:\"loader\"})]});}else{var _id=data._id,likes=data.likes,usersLiked=data.usersLiked,author=data.author,body=data.body,title=data.title,date=data.date,comments=data.comments;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Header,{scroll:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"postContainer\",children:[/*#__PURE__*/_jsx(Content,{postId:_id,likes:likes,usersLiked:usersLiked,author:author,body:body,title:title,date:date}),/*#__PURE__*/_jsxs(\"div\",{className:\"commentContainer\",children:[/*#__PURE__*/_jsx(\"textarea\",{className:\"commentBox\",\"aria-label\":\"Comment Box\",rows:\"1\",cols:\"1\",name:\"Comment Box\",value:commentText,maxLength:\"500\",onInput:handleInput,onFocus:handleFocus,onBlur:handleBlur}),/*#__PURE__*/_jsxs(\"button\",{className:\"commentBtn\",onClick:handleClick,children:[/*#__PURE__*/_jsxs(\"svg\",{width:\"100px\",height:\"40px\",viewBox:\"0 0 100 40\",className:\"border\",children:[/*#__PURE__*/_jsx(\"polyline\",{points:\"99,1 99,39 1,39 1,1 99,1\",className:\"bg-line\"}),/*#__PURE__*/_jsx(\"polyline\",{points:\"99,1 99,39 1,39 1,1 99,1\",className:\"hl-line\"})]}),/*#__PURE__*/_jsx(\"span\",{children:\"Submit\"})]})]}),comments.length>0?/*#__PURE__*/_jsx(Comments,{id:_id,comments:comments}):/*#__PURE__*/_jsx(\"h1\",{className:\"noComments\",children:\"Be the first to comment!\"})]}),/*#__PURE__*/_jsx(Alert,{})]});}};","map":{"version":3,"sources":["C:/Users/cag0398/Desktop/forums/client/src/Post.js"],"names":["useEffect","useReducer","useState","useNavigate","useParams","Header","dateToString","LikeButton","Alert","Reply","reply","author","body","date","time","Replies","replies","slice","reverse","map","_id","Comment","postId","commentId","comment","setReplies","replyText","setText","hideCommentBox","toggleHideCommentBox","toggleReplyBox","user","localStorage","getItem","alertModal","document","getElementById","alertText","innerHTML","style","display","handleClick","target","replyInfo","options","method","headers","JSON","stringify","fetch","oldReplies","Math","floor","random","blur","handleInput","height","scrollHeight","value","handleFocus","handleBlur","Comments","id","comments","Content","likes","usersLiked","title","Post","data","setData","commentText","nav","then","response","json","err","commentInfo","result","length"],"mappings":"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","sourcesContent":["import { useEffect, useReducer, useState } from 'react';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport Header from './header';\r\nimport { dateToString } from './postDate';\r\nimport { LikeButton } from './like';\r\nimport Alert from './alert';\r\n\r\nconst Reply = ({ reply }) => {\r\n  const { author, body, date } = reply;\r\n\r\n  const time = dateToString(date);\r\n\r\n  return (\r\n    <div className=\"reply\">\r\n      <div className=\"authorTime\">\r\n        <h5>{author}</h5>\r\n        <p className=\"time\">{time}</p>\r\n      </div>\r\n\r\n      <p className=\"bodyText\">{body}</p>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst Replies = ({ replies }) => {\r\n  return (\r\n    <div className=\"replies\">\r\n      {replies\r\n        .slice()\r\n        .reverse()\r\n        .map((reply) => {\r\n          return <Reply key={reply._id} reply={reply} />;\r\n        })}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst Comment = ({ postId, commentId, comment }) => {\r\n  const { author, body, date } = comment;\r\n  const [replies, setReplies] = useState(comment.replies);\r\n  const time = dateToString(date);\r\n  const [replyText, setText] = useState('Type reply here...');\r\n\r\n  const [hideCommentBox, toggleHideCommentBox] = useReducer(\r\n    (hideCommentBox) => {\r\n      return !hideCommentBox;\r\n    },\r\n    true\r\n  );\r\n\r\n  const toggleReplyBox = () => {\r\n    const user = localStorage.getItem('name');\r\n    const alertModal = document.getElementById('alertModal');\r\n    const alertText = document.getElementById('alertText');\r\n\r\n    if (!user) {\r\n      alertText.innerHTML = 'You need to login to reply!';\r\n      alertModal.style.display = 'block';\r\n    } else {\r\n      toggleHideCommentBox();\r\n    }\r\n  };\r\n\r\n  // reply box submit button clicked\r\n  const handleClick = ({ target }) => {\r\n    const user = localStorage.getItem('name');\r\n    const alertModal = document.getElementById('alertModal');\r\n    const alertText = document.getElementById('alertText');\r\n\r\n    if (!user) {\r\n      alertText.innerHTML = 'You need to login to submit replies!';\r\n      alertModal.style.display = 'block';\r\n    } else if (replyText === 'Type reply here...') {\r\n      alertText.innerHTML = 'You need to enter text to post a reply!';\r\n      alertModal.style.display = 'block';\r\n    } else {\r\n      const replyInfo = {\r\n        postId,\r\n        commentId,\r\n        author: user,\r\n        body: replyText,\r\n      };\r\n      const options = {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(replyInfo),\r\n      };\r\n\r\n      fetch('/be/newReply', options);\r\n      setReplies((oldReplies) => [\r\n        ...oldReplies,\r\n        {\r\n          _id: Math.floor(Math.random() * 100000),\r\n          date: 'A few seconds ago...',\r\n          author: user,\r\n          body: replyText,\r\n        },\r\n      ]);\r\n      setText('Type reply here...');\r\n    }\r\n    target.blur();\r\n    toggleHideCommentBox();\r\n  };\r\n\r\n  const handleInput = ({ target }) => {\r\n    target.style.height = '';\r\n    target.style.height = target.scrollHeight + 5 + 'px';\r\n    setText(target.value);\r\n  };\r\n\r\n  const handleFocus = ({ target }) => {\r\n    if (target.value === 'Type reply here...') {\r\n      target.value = '';\r\n    }\r\n  };\r\n\r\n  const handleBlur = ({ target }) => {\r\n    if (target.value === '') {\r\n      target.value = 'Type reply here...';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"comment\">\r\n      <div className=\"authorTime\">\r\n        <h5>{author}</h5>\r\n        <p className=\"time\">{time}</p>\r\n      </div>\r\n      <p className=\"bodyText\">{body}</p>\r\n      <button className=\"replyToggleBtn\" onClick={toggleReplyBox}>\r\n        Reply\r\n      </button>\r\n      <div\r\n        className=\"replyContainer\"\r\n        style={{ display: hideCommentBox ? 'none' : 'block' }}\r\n      >\r\n        <textarea\r\n          className=\"commentBox\"\r\n          aria-label=\"Reply Box\"\r\n          rows=\"1\"\r\n          cols=\"1\"\r\n          name=\"Reply Box\"\r\n          value={replyText}\r\n          maxLength={500}\r\n          onFocus={handleFocus}\r\n          onBlur={handleBlur}\r\n          onInput={handleInput}\r\n        ></textarea>\r\n        <button className=\"commentBtn\" onClick={handleClick}>\r\n          <svg\r\n            width=\"100px\"\r\n            height=\"30px\"\r\n            viewBox=\"0 0 100 30\"\r\n            className=\"border\"\r\n          >\r\n            <polyline points=\"99,1 99,29 1,29 1,1 99,1\" className=\"bg-line\" />\r\n            <polyline points=\"99,1 99,29 1,29 1,1 99,1\" className=\"hl-line\" />\r\n          </svg>\r\n          <span>Submit</span>\r\n        </button>\r\n      </div>\r\n      <Replies replies={replies} />\r\n    </div>\r\n  );\r\n};\r\n\r\nconst Comments = ({ id, comments }) => {\r\n  return (\r\n    <div className=\"comments\">\r\n      {comments\r\n        .slice()\r\n        .reverse()\r\n        .map((comment) => {\r\n          return (\r\n            <Comment\r\n              key={comment._id}\r\n              postId={id}\r\n              commentId={comment._id}\r\n              comment={comment}\r\n            />\r\n          );\r\n        })}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst Content = ({ postId, likes, usersLiked, author, body, title, date }) => {\r\n  const time = dateToString(date);\r\n  return (\r\n    <div className=\"content\">\r\n      <LikeButton totalLikes={likes} usersLiked={usersLiked} postId={postId} />\r\n      <div className=\"contentPost\">\r\n        <h3>{title}</h3>\r\n        <div className=\"authorTime\">\r\n          <h5>{author}</h5>\r\n          <p className=\"time\">{time}</p>\r\n        </div>\r\n        <p className=\"bodyText\">{body}</p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const Post = () => {\r\n  const { id } = useParams();\r\n\r\n  const [data, setData] = useState(null);\r\n  const [commentText, setText] = useState('Type comment here...');\r\n  const nav = useNavigate();\r\n\r\n  useEffect(() => {\r\n    fetch(`/be/getPost/${id}`)\r\n      .then((response) => response.json())\r\n      .then((response) => {\r\n        // post id not found\r\n        if (!response || response.err) {\r\n          nav('/oops');\r\n        } else {\r\n          setData(response);\r\n          document.title = `${response.title} - Denton Forums`;\r\n        }\r\n      });\r\n  }, [nav, id]);\r\n\r\n  const handleInput = ({ target }) => {\r\n    target.style.height = '';\r\n    target.style.height = target.scrollHeight + 5 + 'px';\r\n    setText(target.value);\r\n  };\r\n\r\n  const handleFocus = ({ target }) => {\r\n    if (target.value === 'Type comment here...') {\r\n      target.value = '';\r\n    }\r\n  };\r\n\r\n  const handleBlur = ({ target }) => {\r\n    if (target.value === '') {\r\n      target.value = 'Type comment here...';\r\n    }\r\n  };\r\n\r\n  // comment submit button clicked\r\n  const handleClick = ({ target }) => {\r\n    const user = localStorage.getItem('name');\r\n    const alertModal = document.getElementById('alertModal');\r\n    const alertText = document.getElementById('alertText');\r\n\r\n    if (!user) {\r\n      alertText.innerHTML = 'You need to login to submit comments!';\r\n      alertModal.style.display = 'block';\r\n    } else if (commentText === 'Type comment here...') {\r\n      alertText.innerHTML = 'You need to enter text to post a comment!';\r\n      alertModal.style.display = 'block';\r\n    } else {\r\n      const commentInfo = {\r\n        postId: id,\r\n        author: user,\r\n        body: commentText,\r\n      };\r\n      const options = {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(commentInfo),\r\n      };\r\n\r\n      fetch('/be/newComment', options)\r\n        .then((response) => response.json())\r\n        .then((response) => setData(response.result));\r\n      setText('Type comment here...');\r\n    }\r\n    target.blur();\r\n  };\r\n\r\n  if (!data) {\r\n    return (\r\n      <>\r\n        <Header />\r\n        <div className=\"loader\"></div>\r\n      </>\r\n    );\r\n  } else {\r\n    const { _id, likes, usersLiked, author, body, title, date, comments } =\r\n      data;\r\n    return (\r\n      <>\r\n        <Header scroll={true} />\r\n        <div className=\"postContainer\">\r\n          <Content\r\n            postId={_id}\r\n            likes={likes}\r\n            usersLiked={usersLiked}\r\n            author={author}\r\n            body={body}\r\n            title={title}\r\n            date={date}\r\n          />\r\n          <div className=\"commentContainer\">\r\n            <textarea\r\n              className=\"commentBox\"\r\n              aria-label=\"Comment Box\"\r\n              rows=\"1\"\r\n              cols=\"1\"\r\n              name=\"Comment Box\"\r\n              value={commentText}\r\n              maxLength=\"500\"\r\n              onInput={handleInput}\r\n              onFocus={handleFocus}\r\n              onBlur={handleBlur}\r\n            ></textarea>\r\n            <button className=\"commentBtn\" onClick={handleClick}>\r\n              <svg\r\n                width=\"100px\"\r\n                height=\"40px\"\r\n                viewBox=\"0 0 100 40\"\r\n                className=\"border\"\r\n              >\r\n                <polyline\r\n                  points=\"99,1 99,39 1,39 1,1 99,1\"\r\n                  className=\"bg-line\"\r\n                />\r\n                <polyline\r\n                  points=\"99,1 99,39 1,39 1,1 99,1\"\r\n                  className=\"hl-line\"\r\n                />\r\n              </svg>\r\n              <span>Submit</span>\r\n            </button>\r\n          </div>\r\n          {comments.length > 0 ? (\r\n            <Comments id={_id} comments={comments} />\r\n          ) : (\r\n            <h1 className=\"noComments\">Be the first to comment!</h1>\r\n          )}\r\n        </div>\r\n        <Alert />\r\n      </>\r\n    );\r\n  }\r\n};\r\n"]},"metadata":{},"sourceType":"module"}